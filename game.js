
// Idle Pickaxe Miner â€” Full Deluxe Build
// Includes glossy pickaxe animation, particles, skins, shop, prestige, offline idle
(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  let W = canvas.width = window.innerWidth, H = canvas.height = window.innerHeight;

  const KEY = 'idle_miner_full_state_v1';
  let state = JSON.parse(localStorage.getItem(KEY) || 'null') || {
    money:0,dmg:1,idle:0,rockIndex:0,rockHP:null,rockMax:null,skinsOwned:['Basic'],skin:'Basic',prestige:0,lastTick:Date.now()
  };

  const ORES = [
    {name:'Stone', hp:50, reward:10},
    {name:'Copper', hp:120, reward:30},
    {name:'Iron', hp:340, reward:90},
    {name:'Gold', hp:900, reward:300},
    {name:'Diamond', hp:2400, reward:1000},
    {name:'Mythic', hp:7000, reward:4000}
  ];

  const SKINS = [
    {name:'Basic', cost:0, color:'#ffb86b'},
    {name:'Rusty', cost:100, color:'#c07c4e'},
    {name:'Shiny', cost:500, color:'#f9f871'},
    {name:'Crystal', cost:2500, color:'#7be3ff'}
  ];

  // base64 embedded crack (fallback) and external load path
  const crackEmbedded = "data:audio/wav;base64,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";
  let crackAudio = new Audio(crackEmbedded);
  crackAudio.volume = 0.8;

  function save() { state.lastTick = Date.now(); localStorage.setItem(KEY, JSON.stringify(state)); }

  function ensureRock() { if (state.rockMax == null) { const o = ORES[state.rockIndex]; state.rockMax = Math.round(o.hp * Math.pow(1.4, state.rockIndex)); state.rockHP = state.rockMax; } }
  ensureRock();

  (function applyOffline(){ const now = Date.now(); const elapsed = Math.floor((now - (state.lastTick || now))/1000); if (elapsed>0) state.money += state.idle * elapsed; })();

  // UI refs
  const moneyEl = document.getElementById('money'), dmgEl = document.getElementById('dmg'), idleEl = document.getElementById('idle');
  const shopPanel = document.getElementById('shop'), shopItems = document.getElementById('shopItems');
  const toShopBtn = document.getElementById('toShop'), closeShopBtn = document.getElementById('closeShop'), prestigeBtn = document.getElementById('prestigeBtn');
  const rockTypeEl = document.getElementById('rockType'), rockHPEl = document.getElementById('rockHP'), rockMaxEl = document.getElementById('rockMax');
  const skinNameEl = document.getElementById('skinName'), prestigeMulEl = document.getElementById('prestigeMul');

  const particles = [];
  function spawnParticles(x,y,color,count=12){ for(let i=0;i<count;i++) particles.push({x,y,vx:(Math.random()-0.5)*6,vy:(Math.random()-1.5)*6,life:40+Math.random()*30,color}); }

  let swing=0,swingActive=false,swingStrength=1;
  function prestigeMultiplier(){return 1 + state.prestige*0.2;}

  function onHit(power){ const mul = prestigeMultiplier(); const dmg = power * (state.dmg||1); state.rockHP -= dmg; spawnParticles(W/2,H/2,'#fff',8); try{ crackAudio.currentTime = 0; crackAudio.volume = Math.min(1,0.6 + power*0.05); crackAudio.play(); }catch(e){} if (state.rockHP<=0){ const ore=ORES[state.rockIndex]; const baseReward=ore.reward; const reward=Math.round(baseReward * Math.pow(1.15, state.rockIndex) * mul); state.money += reward; try{ crackAudio.currentTime = 0; crackAudio.volume = 1.0; crackAudio.play(); }catch(e){} spawnParticles(W/2,H/2,'#ffd87a',30); state.rockIndex = Math.min(state.rockIndex+1, ORES.length-1); state.rockMax = Math.round((ORES[state.rockIndex].hp) * Math.pow(1.4, state.rockIndex)); state.rockHP = state.rockMax; } save(); }

  // input
  let tStart=null; canvas.addEventListener('touchstart',e=>{tStart=e.touches[0];}); canvas.addEventListener('touchend',e=>{ if(!tStart) return; const t=e.changedTouches[0]; const dx=t.clientX-tStart.clientX; const dy=t.clientY-tStart.clientY; const dist=Math.sqrt(dx*dx+dy*dy); if(dist>30){ const power=Math.min(8, Math.floor(dist/18)+1); swingStrength=Math.min(2.5,0.9+power*0.25); startSwing(); onHit(power);} else { swingStrength=0.9; startSwing(); onHit(1);} tStart=null; });
  let mDown=false,mStart=null; canvas.addEventListener('mousedown',e=>{mDown=true;mStart=e;}); canvas.addEventListener('mouseup',e=>{ if(!mStart) return; const dx=e.clientX-mStart.clientX; const dy=e.clientY-mStart.clientY; const dist=Math.sqrt(dx*dx+dy*dy); if(dist>30){ const power=Math.min(8, Math.floor(dist/18)+1); swingStrength=Math.min(2.5,0.9+power*0.25); startSwing(); onHit(power);} else { swingStrength=0.9; startSwing(); onHit(1);} mDown=false; mStart=null; });

  function startSwing(){ swing=0; swingActive=true; }

  function buildShop(){ shopItems.innerHTML=''; const dmgUpgradeCost=Math.round(20 * Math.pow(1.6, state.dmg-1)); const li1=document.createElement('div'); li1.className='shop-item'; li1.innerHTML=`<div>Upgrade Pickaxe +1 (cost ${dmgUpgradeCost})</div><div><button class="btn" id="buyDmg">Buy</button></div>`; shopItems.appendChild(li1); document.getElementById('buyDmg').onclick=()=>{ if(state.money>=dmgUpgradeCost){ state.money-=dmgUpgradeCost; state.dmg++; save(); updateUI(); buildShop(); } else alert('Not enough money'); }; const idleCost=Math.round(50 * Math.pow(2, state.idle)); const li2=document.createElement('div'); li2.className='shop-item'; li2.innerHTML=`<div>Hire Miner +1 (cost ${idleCost})</div><div><button class="btn" id="buyIdle">Buy</button></div>`; shopItems.appendChild(li2); document.getElementById('buyIdle').onclick=()=>{ if(state.money>=idleCost){ state.money-=idleCost; state.idle++; save(); updateUI(); buildShop(); } else alert('Not enough money'); }; const skinHeader=document.createElement('div'); skinHeader.className='small'; skinHeader.textContent='Skins'; shopItems.appendChild(skinHeader); SKINS.forEach(s=>{ const owned=state.skinsOwned.includes(s.name); const div=document.createElement('div'); div.className='shop-item'; div.innerHTML=`<div><span class="skin-preview" style="background:${s.color}"></span>${s.name} ${owned ? '(Owned)' : ''}</div><div><button class="btn buy-skin" data-name="${s.name}" ${owned ? 'disabled' : ''}>${owned ? 'Owned' : 'Buy '+s.cost}</button></div>`; shopItems.appendChild(div); }); Array.from(document.querySelectorAll('.buy-skin')).forEach(btn=>{ btn.onclick=()=>{ const name=btn.dataset.name; const sdata=SKINS.find(x=>x.name===name); if(!sdata) return; if(state.skinsOwned.includes(name)) return alert('You own it'); if(state.money>=sdata.cost){ state.money-=sdata.cost; state.skinsOwned.push(name); state.skin=name; save(); updateUI(); buildShop(); } else alert('Not enough money'); }; }); const oresHeader=document.createElement('div'); oresHeader.className='small'; oresHeader.textContent='Ores'; shopItems.appendChild(oresHeader); ORES.forEach((o,i)=>{ const cost=Math.round(o.reward * Math.pow(3, i) * 0.5); const div=document.createElement('div'); div.className='shop-item'; div.innerHTML=`<div>${o.name} (reward ${o.reward})</div><div><button class="btn buy-ore" data-index="${i}">Warp (${cost})</button></div>`; shopItems.appendChild(div); }); Array.from(document.querySelectorAll('.buy-ore')).forEach(btn=>{ btn.onclick=()=>{ const idx=parseInt(btn.dataset.index,10); const cost=Math.round(ORES[idx].reward * Math.pow(3, idx) * 0.5); if(state.money>=cost){ state.money-=cost; state.rockIndex=idx; state.rockMax=Math.round((ORES[state.rockIndex].hp) * Math.pow(1.4, state.rockIndex)); state.rockHP=state.rockMax; save(); updateUI(); buildShop(); } else alert('Not enough money'); }; }); }

  function doPrestige(){ if(!confirm('Prestige will reset money, upgrades, and ores for a permanent multiplier. Continue?')) return; state.prestige++; state.money=0; state.dmg=1; state.idle=0; state.rockIndex=0; state.rockMax=null; state.rockHP=null; state.skinsOwned=['Basic']; state.skin='Basic'; save(); updateUI(); buildShop(); }

  toShopBtn.onclick = ()=>{ shopPanel.style.display='block'; buildShop(); updateUI(); };
  closeShopBtn.onclick = ()=>{ shopPanel.style.display='none'; updateUI(); };
  prestigeBtn.onclick = ()=> doPrestige();

  function updateUI(){ moneyEl.textContent=Math.floor(state.money); dmgEl.textContent=state.dmg; idleEl.textContent=state.idle; rockTypeEl.textContent=(ORES[state.rockIndex]||ORES[0]).name; rockHPEl.textContent=Math.floor(state.rockHP||0); rockMaxEl.textContent=Math.floor(state.rockMax||0); skinNameEl.textContent=state.skin; prestigeMulEl.textContent=(1+state.prestige*0.2).toFixed(2); }

  // draw glossy pickaxe and rock + particles
  function drawPickaxe(cx,cy,r,angle,skinColor){ ctx.save(); ctx.translate(cx,cy); ctx.rotate(angle); ctx.fillStyle = '#5a3b29'; ctx.fillRect(-r*0.05,10,r*0.9,r*0.14); ctx.fillStyle='#3a2a20'; ctx.fillRect(r*0.6,10,r*0.1,r*0.14); ctx.beginPath(); ctx.fillStyle=skinColor||'#ffb86b'; ctx.moveTo(-r*0.1,-r*0.2); ctx.lineTo(r*0.9,-r*0.6); ctx.lineTo(r*0.9,r*0.6); ctx.lineTo(-r*0.1,r*0.2); ctx.closePath(); ctx.fill(); const grad=ctx.createLinearGradient(-r*0.1,-r*0.6,r*0.9,r*0.6); grad.addColorStop(0,'rgba(255,255,255,0.35)'); grad.addColorStop(0.6,'rgba(255,255,255,0.05)'); ctx.fillStyle=grad; ctx.moveTo(-r*0.05,-r*0.15); ctx.quadraticCurveTo(r*0.5,-r*0.5,r*0.85,0); ctx.lineTo(r*0.85,6); ctx.quadraticCurveTo(r*0.4,-r*0.05,-r*0.05,6); ctx.fill(); ctx.restore(); }

  function draw(){ W = canvas.width = window.innerWidth; H = canvas.height = window.innerHeight; ctx.clearRect(0,0,W,H); const grd = ctx.createLinearGradient(0,0,0,H); grd.addColorStop(0,'#07101a'); grd.addColorStop(1,'#071827'); ctx.fillStyle = grd; ctx.fillRect(0,0,W,H); const cx = W/2, cy = H/2; const r = Math.min(180, Math.min(W,H)*0.26); const ore = ORES[state.rockIndex]||ORES[0]; const rockCol = {{'Stone':'#666','Copper':'#8b5a2b','Iron':'#9fa6ad','Gold':'#f5c542','Diamond':'#7ef0ff','Mythic':'#c67cff'}}[ore.name]||'#666'; ctx.beginPath(); ctx.fillStyle = rockCol; ctx.arc(cx,cy,r,0,Math.PI*2); ctx.fill(); const pct = state.rockHP / state.rockMax; ctx.strokeStyle = `rgba(0,0,0,${0.5 + (1-pct)*0.9})`; ctx.lineWidth = 4; ctx.beginPath(); for(let i=0;i<6;i++){ const a1 = Math.PI*2*(i/6); const a2 = a1 + (Math.random()-0.5)*0.4; ctx.moveTo(cx + Math.cos(a1)*r*0.2, cy + Math.sin(a1)*r*0.2); ctx.lineTo(cx + Math.cos(a2)*(r*0.9*(0.6 + (1-pct)*0.4)), cy + Math.sin(a2)*(r*0.9*(0.6 + (1-pct)*0.4))); } ctx.stroke(); if(swingActive){ swing += 0.06 * swingStrength; if(swing >= 1){ swing = 0; swingActive=false; } } const swingAngle = Math.sin(swing * Math.PI) * (-1.2 * swingStrength); const skinColor = (SKINS.find(s=>s.name===state.skin) || SKINS[0]).color || '#ffb86b'; drawPickaxe(cx - r*0.2, cy - r*0.1, r*0.9, swingAngle, skinColor); for(let i=particles.length-1;i>=0;i--){ const p = particles[i]; p.x += p.vx; p.y += p.vy; p.vy += 0.25; p.life--; ctx.globalAlpha = Math.max(0, p.life/60); ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, 4, 4); ctx.globalAlpha = 1; if(p.life <= 0) particles.splice(i,1); } updateUI(); requestAnimationFrame(draw); } draw(); setInterval(()=>{ state.money += state.idle; save(); }, 1000); window.addEventListener('resize', ()=>{ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }); function ensureInit(){ if(!state.rockMax){ state.rockMax = Math.round((ORES[state.rockIndex].hp) * Math.pow(1.4, state.rockIndex)); state.rockHP = state.rockMax; } save(); updateUI(); } ensureInit();
